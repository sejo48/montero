<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ficha T√©cnica Veh√≠culos de Jorge</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilo para la fuente Inter, si est√° disponible */
        body {
            font-family: 'Inter', Arial, sans-serif;
        }
        /* Estilos personalizados para el modal y transiciones */
        .modal-overlay, #imagenCompletaModal {
            transition: opacity 0.3s ease-in-out;
        }
        .modal-content, #imagenCompletaModal #imagenCompletaContenedor img, #imagenCompletaModal #imagenCompletaContenedor textarea {
            transition: transform 0.3s ease-in-out;
        }
        /* Ocultar scrollbars en iframes y asegurar que no tengan borde */
        iframe {
            border: none; 
        }
        /* Estilo para las im√°genes de la galer√≠a */
        .gallery-image {
            width: 100%;
            height: 150px; /* Altura fija para las miniaturas */
            object-fit: cover; /* Asegura que la imagen cubra el espacio sin distorsionarse */
            border-radius: 0.5rem; /* Esquinas redondeadas */
            box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Sombra sutil */
            cursor: pointer; /* Indica que es clickeable */
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
        }
        .gallery-image:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* Estilos para el modal de imagen a pantalla completa */
        #imagenCompletaSrc {
            border-radius: 0.5rem; /* Esquinas redondeadas para la imagen grande */
            box-shadow: 0 0 30px rgba(0,0,0,0.5); /* Sombra m√°s pronunciada */
        }
        #botonEliminarImagen {
            background-color: rgba(239, 68, 68, 0.8); /* Rojo semitransparente */
            color: white;
            border-radius: 50%;
            width: 32px;
            height: 32px;
            font-size: 20px;
            line-height: 32px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        #botonEliminarImagen:hover {
            background-color: rgba(220, 38, 38, 1); /* Rojo m√°s opaco */
        }
        #detallesTextarea {
            width: 100%;
            min-height: 60px;
            padding: 8px;
            border: 1px solid #4A5568; /* gris oscuro */
            border-radius: 0.375rem; /* esquinas redondeadas */
            background-color: #2D3748; /* fondo gris m√°s oscuro */
            color: #E2E8F0; /* texto claro */
            margin-top: 0.75rem; /* mt-3 */
            font-size: 0.875rem; /* text-sm */
        }
        /* Transici√≥n para el contenedor de acciones colapsable */
        .acciones-contenedor {
            transition: max-height 0.5s ease-in-out, opacity 0.5s ease-in-out;
            overflow: hidden;
            max-height: 0; /* Inicialmente colapsado */
            opacity: 0; /* Inicialmente transparente */
        }
        .acciones-contenedor.visible {
            max-height: 500px; /* Altura suficiente para los botones, ajustar si es necesario */
            opacity: 1;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800 p-4 md:p-8">

    <div class="max-w-5xl mx-auto">

        <header class="mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-sky-700 bg-sky-100 p-4 rounded-lg shadow-md">Ficha T√©cnica - Veh√≠culos de Jorge</h1>
        </header>

        <main class="space-y-8">

            <article class="bg-white p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4 border-b-2 border-sky-200 pb-2">Mitsubishi Montero Sport 1999</h2>
                <div class="grid md:grid-cols-2 gap-x-8 gap-y-4 mb-6">
                    <div><p><strong>Motor:</strong> 6G72 (3.0L V6 SOHC 24 v√°lvulas)</p></div>
                    <div><p><strong>Potencia:</strong> 173 hp @ 5,000 rpm</p></div>
                    <div><p><strong>Torque:</strong> 228 lb-ft @ 3,500 rpm</p></div>
                    <div><p><strong>Transmisi√≥n:</strong> Autom√°tica R4AW3</p></div>
                    <div><p><strong>Tracci√≥n:</strong> 4x2 (trasera)</p></div>
                    <div><p><strong>Neum√°ticos:</strong> 265/70R15 110S</p></div>
                    <div><p><strong>Presi√≥n:</strong> 26 PSI</p></div>
                    <div><p><strong>Peso bruto:</strong> 2.268 kg (5005 lbs)</p></div>
                    <div><p><strong>VIN:</strong> JA4LS31P4WP018774</p></div>
                    <div><p><strong>Color exterior:</strong> 4636</p></div>
                    <div><p><strong>Color interior:</strong> P85S74</p></div>
                </div>
                
                <div class="mt-4">
                    <button 
                        id="toggleBotonMontero"
                        onclick="toggleAcciones('Montero')" 
                        class="md:hidden bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md w-full text-left mb-3 transition-all duration-300 ease-in-out flex justify-between items-center"
                        aria-expanded="false"
                        aria-controls="accionesContenedorMontero">
                        <span id="toggleTextoMontero">Acciones del Veh√≠culo</span>
                        <span id="iconoToggleMontero" class="transform transition-transform duration-300">‚ò∞</span>
                    </button>
                    <div id="accionesContenedorMontero" class="acciones-contenedor md:flex md:flex-row md:flex-wrap md:gap-3 md:justify-start md:max-h-none md:opacity-100 md:overflow-visible">
                        <button onclick="abrirInputGaleria('Montero')" class="bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105 w-full md:w-auto mb-2 md:mb-0">
                            üì∑ Fotos
                        </button>
                        <input type="file" id="galeriaInputMontero" multiple accept="image/*" class="hidden" onchange="mostrarImagenesSeleccionadas(event, 'galeriaDisplayMontero', 'galeriaMensajeMontero', 'Montero')">
                        
                        <button onclick="mostrarMensaje('Mantenimiento Montero', 'Pr√≥ximamente: Historial de mantenimientos del Mitsubishi Montero Sport.')" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105 w-full md:w-auto mb-2 md:mb-0">
                            üõ† Mantenimiento
                        </button>
                        <button onclick="mostrarMensaje('Recordatorios Montero', 'Recordatorio: Revisi√≥n anual pendiente para el Mitsubishi Montero Sport.')" class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105 w-full md:w-auto mb-2 md:mb-0">
                            üìÖ Recordatorios
                        </button>
                        <button onclick="mostrarManual('manualMontero', this)" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105 w-full md:w-auto">
                            üìÑ Ver Manual PDF
                        </button>
                    </div>
                </div>

                <p id="galeriaMensajeMontero" class="text-sm text-gray-600 mt-3 hidden"></p>
                <div id="galeriaDisplayMontero" class="mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div> <iframe id="manualMontero" class="w-full h-0 mt-4 rounded-lg shadow-inner overflow-hidden transition-all duration-500 ease-in-out" src="https://docs.google.com/gview?url=https://drive.google.com/uc?id=1Bodq-vN6s0JJ60ueDhhxvYbOWRXHQaqf&embedded=true" allow="fullscreen"></iframe>
                <p id="manualMonteroError" class="text-red-500 mt-2 hidden">No se pudo cargar el manual. Por favor, verifica el enlace o int√©ntalo m√°s tarde.</p>
            </article>

            <article class="bg-white p-6 rounded-xl shadow-lg hover:shadow-2xl transition-shadow duration-300">
                <h2 class="text-2xl font-semibold text-sky-600 mb-4 border-b-2 border-sky-200 pb-2">Mitsubishi Lancer 2000</h2>
                <div class="grid md:grid-cols-2 gap-x-8 gap-y-4 mb-6">
                    <div><p><strong>Modelo:</strong> CK4ASNJEL</p></div>
                    <div><p><strong>Motor:</strong> 4G92 (1.6L DOHC 16V)</p></div>
                    <div><p><strong>Potencia:</strong> 113 hp @ 6,000 rpm</p></div>
                    <div><p><strong>Torque:</strong> 137 Nm @ 4,500 rpm</p></div>
                    <div><p><strong>Transmisi√≥n:</strong> Manual F5M41</p></div>
                    <div><p><strong>Color exterior:</strong> G13D</p></div>
                    <div><p><strong>Color interior:</strong> G13</p></div>
                    <div><p><strong>Opciones:</strong> 83A H94</p></div>
                </div>

                <div class="mt-4">
                    <button 
                        id="toggleBotonLancer"
                        onclick="toggleAcciones('Lancer')" 
                        class="md:hidden bg-slate-600 hover:bg-slate-700 text-white font-semibold py-2 px-4 rounded-lg shadow-md w-full text-left mb-3 transition-all duration-300 ease-in-out flex justify-between items-center"
                        aria-expanded="false"
                        aria-controls="accionesContenedorLancer">
                        <span id="toggleTextoLancer">Acciones del Veh√≠culo</span>
                        <span id="iconoToggleLancer" class="transform transition-transform duration-300">‚ò∞</span>
                    </button>
                    <div id="accionesContenedorLancer" class="acciones-contenedor md:flex md:flex-row md:flex-wrap md:gap-3 md:justify-start md:max-h-none md:opacity-100 md:overflow-visible">
                        <button onclick="abrirInputGaleria('Lancer')" class="bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105 w-full md:w-auto mb-2 md:mb-0">
                            üì∑ Fotos
                        </button>
                        <input type="file" id="galeriaInputLancer" multiple accept="image/*" class="hidden" onchange="mostrarImagenesSeleccionadas(event, 'galeriaDisplayLancer', 'galeriaMensajeLancer', 'Lancer')">
                        
                        <button onclick="mostrarMensaje('Mantenimiento Lancer', 'Pr√≥ximamente: Historial de mantenimientos del Mitsubishi Lancer.')" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105 w-full md:w-auto mb-2 md:mb-0">
                            üõ† Mantenimiento
                        </button>
                        <button onclick="mostrarMensaje('Recordatorios Lancer', 'Recordatorio: Cambio de aceite en junio para el Mitsubishi Lancer.')" class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105 w-full md:w-auto mb-2 md:mb-0">
                            üìÖ Recordatorios
                        </button>
                        <button onclick="mostrarManual('manualLancer', this)" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-2 px-4 rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out transform hover:scale-105 w-full md:w-auto">
                            üìÑ Ver Manual PDF
                        </button>
                    </div>
                </div>

                <p id="galeriaMensajeLancer" class="text-sm text-gray-600 mt-3 hidden"></p>
                <div id="galeriaDisplayLancer" class="mt-4 grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div> <iframe id="manualLancer" class="w-full h-0 mt-4 rounded-lg shadow-inner overflow-hidden transition-all duration-500 ease-in-out" src="https://docs.google.com/gview?url=https://drive.google.com/uc?id=1Bodq-vN6s0JJ60ueDhhxvYbOWRXHQaqf&embedded=true" allow="fullscreen"></iframe>
                <p id="manualLancerError" class="text-red-500 mt-2 hidden">No se pudo cargar el manual. Por favor, verifica el enlace o int√©ntalo m√°s tarde.</p>
            </article>
        </main>
    </div>

    <div id="mensajeModal" class="modal-overlay fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 hidden z-50 opacity-0">
        <div class="modal-content bg-white p-6 rounded-lg shadow-xl max-w-sm w-full transform scale-95">
            <div class="flex justify-between items-center mb-4">
                <h3 id="mensajeModalTitulo" class="text-xl font-semibold text-sky-700">Mensaje</h3>
                <button onclick="cerrarMensaje()" class="text-gray-500 hover:text-gray-700 text-2xl" aria-label="Cerrar mensaje">&times;</button>
            </div>
            <p id="mensajeModalContenido" class="text-gray-700"></p>
            <div class="mt-6 text-right">
                <button onclick="cerrarMensaje()" class="bg-sky-500 hover:bg-sky-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:shadow-md transition-all duration-200">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <div id="imagenCompletaModal" class="fixed inset-0 bg-black bg-opacity-90 flex flex-col items-center justify-center p-4 hidden z-[60] opacity-0" role="dialog" aria-modal="true" aria-labelledby="imagenCompletaTituloModal">
        <div class="absolute top-2 right-2 md:top-4 md:right-4 flex items-center space-x-2 z-10">
            <button id="botonEliminarImagen" onclick="eliminarImagenActualDesdeLightbox()" title="Eliminar imagen" aria-label="Eliminar imagen">&times;</button>
            <button onclick="cerrarImagenCompleta()" class="text-white text-3xl md:text-4xl font-bold hover:text-gray-300 bg-black bg-opacity-30 rounded-full p-1 leading-none" aria-label="Cerrar imagen">&times;</button>
        </div>
        
        <div id="imagenCompletaContenedor" class="relative w-full max-w-3xl max-h-[90vh] flex flex-col items-center">
            <img id="imagenCompletaSrc" src="" alt="Imagen a pantalla completa" class="max-w-[95vw] max-h-[70vh] object-contain mb-3">
            <div class="w-full px-2">
                <p id="imagenCompletaNombre" class="text-white text-center text-sm md:text-base mb-1"></p>
                <textarea id="detallesTextarea" placeholder="A√±ade detalles aqu√≠..." aria-label="Detalles de la imagen"></textarea>
            </div>
        </div>
    </div>

    <script>
        let visibleIframeId = null;
        let activeButton = null;
        let galeriasData = { Montero: [], Lancer: [] };
        let currentLightboxImageInfo = { sufijo: null, index: null };

        /**
         * Alterna la visibilidad del contenedor de acciones para un veh√≠culo espec√≠fico en vista m√≥vil.
         * @param {string} sufijoVehiculo - El sufijo identificador del veh√≠culo (ej. 'Montero').
         */
        function toggleAcciones(sufijoVehiculo) {
            const contenedorAcciones = document.getElementById('accionesContenedor' + sufijoVehiculo);
            const botonToggle = document.getElementById('toggleBoton' + sufijoVehiculo);
            const iconoToggle = document.getElementById('iconoToggle' + sufijoVehiculo);
            const textoBoton = document.getElementById('toggleTexto' + sufijoVehiculo);

            const isExpanded = botonToggle.getAttribute('aria-expanded') === 'true';

            if (isExpanded) {
                // Colapsar
                contenedorAcciones.classList.remove('visible');
                // Las clases de Tailwind 'acciones-contenedor' manejan la animaci√≥n de colapso (max-height y opacity)
                // Para asegurar que md:flex funcione, no a√±adimos 'hidden' aqu√≠, la animaci√≥n lo oculta.
                // En su lugar, las clases base de 'acciones-contenedor' lo ocultan inicialmente.
                // Y 'md:flex', 'md:max-h-none', 'md:opacity-100' lo fuerzan a ser visible en pantallas md+
                botonToggle.setAttribute('aria-expanded', 'false');
                if (iconoToggle) iconoToggle.innerHTML = '‚ò∞'; // Icono de hamburguesa
                if (textoBoton) textoBoton.textContent = 'Acciones del Veh√≠culo';
                if (iconoToggle) iconoToggle.classList.remove('rotate-180');

            } else {
                // Expandir
                contenedorAcciones.classList.add('visible');
                // Las clases de Tailwind 'acciones-contenedor visible' manejan la animaci√≥n de expansi√≥n.
                botonToggle.setAttribute('aria-expanded', 'true');
                if (iconoToggle) iconoToggle.innerHTML = '&times;'; // Icono de X (cerrar)
                if (textoBoton) textoBoton.textContent = 'Ocultar Acciones';
                if (iconoToggle) iconoToggle.classList.add('rotate-180');
            }
        }


        function abrirInputGaleria(sufijoVehiculo) {
            document.getElementById('galeriaInput' + sufijoVehiculo).click();
        }

        function mostrarImagenesSeleccionadas(event, idGaleriaDisplay, idGaleriaMensaje, sufijoVehiculo) {
            const files = event.target.files;
            // Reiniciar galer√≠a para este veh√≠culo al cargar nuevas im√°genes
            galeriasData[sufijoVehiculo] = []; 
            // Limpiar visualizaci√≥n anterior antes de procesar nuevos archivos
            document.getElementById(idGaleriaDisplay).innerHTML = '';
            document.getElementById(idGaleriaDisplay).classList.add('hidden'); // Ocultar hasta que haya im√°genes v√°lidas


            if (!files || files.length === 0) {
                actualizarMensajeGaleria(idGaleriaMensaje, 0, 0);
                event.target.value = null;
                return;
            }

            let imagesProcessedCount = 0;
            const totalFiles = files.length;
            let validImagesCount = 0;

            Array.from(files).forEach((file) => {
                if (!file.type.startsWith('image/')) {
                    console.warn(`El archivo "${file.name}" no es una imagen y ser√° omitido.`);
                    imagesProcessedCount++;
                    if (imagesProcessedCount === totalFiles) {
                         // Solo regenerar si todos los archivos han sido procesados
                        regenerarGaleria(sufijoVehiculo, idGaleriaDisplay, idGaleriaMensaje);
                    }
                    return;
                }

                const reader = new FileReader();
                reader.onload = (e) => {
                    const imageData = {
                        src: e.target.result,
                        name: file.name,
                        type: file.type,
                        details: "" 
                    };
                    galeriasData[sufijoVehiculo].push(imageData);
                    // No incrementar validImagesCount aqu√≠, se cuenta al regenerar
                    imagesProcessedCount++;
                    if (imagesProcessedCount === totalFiles) {
                        regenerarGaleria(sufijoVehiculo, idGaleriaDisplay, idGaleriaMensaje);
                    }
                };
                reader.onerror = () => {
                    console.error(`Error al leer el archivo ${file.name}.`);
                    imagesProcessedCount++;
                    if (imagesProcessedCount === totalFiles) {
                        // Considerar un mensaje de error espec√≠fico si es necesario
                        regenerarGaleria(sufijoVehiculo, idGaleriaDisplay, idGaleriaMensaje);
                    }
                };
                reader.readAsDataURL(file);
            });
            event.target.value = null;
        }
        
        function regenerarGaleria(sufijoVehiculo, idGaleriaDisplay, idGaleriaMensaje) {
            const galeriaDisplay = document.getElementById(idGaleriaDisplay);
            galeriaDisplay.innerHTML = ''; // Limpiar galer√≠a existente

            const vehicleImages = galeriasData[sufijoVehiculo];
            if (!vehicleImages || vehicleImages.length === 0) {
                galeriaDisplay.classList.add('hidden'); // Ocultar si no hay im√°genes
                 // No mostrar mensaje de "No hay im√°genes" si el input acaba de ser limpiado y no se seleccion√≥ nada.
                // El mensaje se actualiza en mostrarImagenesSeleccionadas o actualizarMensajeGaleria
            } else {
                galeriaDisplay.classList.remove('hidden'); // Mostrar si hay im√°genes
                vehicleImages.forEach((imageData, index) => {
                    const imgElement = document.createElement('img');
                    imgElement.src = imageData.src;
                    imgElement.alt = `Miniatura de ${imageData.name}`;
                    imgElement.classList.add('gallery-image');
                    imgElement.dataset.sufijo = sufijoVehiculo;
                    imgElement.dataset.index = index;
                    imgElement.onclick = () => mostrarImagenCompleta(sufijoVehiculo, index);
                    galeriaDisplay.appendChild(imgElement);
                });
            }
            // Actualizar el mensaje basado en las im√°genes realmente en galeriasData[sufijoVehiculo]
            // El total de intentos es un poco m√°s complejo de rastrear hasta aqu√≠, as√≠ que simplificamos.
            actualizarMensajeGaleria(idGaleriaMensaje, vehicleImages.length, vehicleImages.length); 
        }

        function actualizarMensajeGaleria(idGaleriaMensaje, cargadas, totalIntentosOriginales, errorGeneral = false) {
            const mensajeEl = document.getElementById(idGaleriaMensaje);
            if (errorGeneral) { // Un error general al procesar archivos
                mensajeEl.textContent = `Error al cargar algunas im√°genes. ${cargadas} v√°lida(s) procesada(s).`;
            } else if (cargadas > 0) {
                mensajeEl.textContent = `${cargadas} im√°gen(es) cargada(s) exitosamente.`;
                // Si se quisiera rastrear archivos omitidos, se necesitar√≠a pasar esa info.
            } else if (totalIntentosOriginales === 0 && cargadas === 0) { // No se seleccion√≥ nada o se limpi√≥
                 mensajeEl.textContent = 'No se seleccionaron im√°genes.';
            } else { // Se intent√≥ cargar pero ninguna fue v√°lida
                mensajeEl.textContent = 'Ning√∫n archivo seleccionado era una imagen v√°lida o hubo errores.';
            }
            mensajeEl.classList.remove('hidden');
        }


        function mostrarImagenCompleta(sufijoVehiculo, index) {
            const imageData = galeriasData[sufijoVehiculo][index];
            if (!imageData) return;

            currentLightboxImageInfo = { sufijo: sufijoVehiculo, index: index };

            document.getElementById('imagenCompletaSrc').src = imageData.src;
            document.getElementById('imagenCompletaSrc').alt = `Imagen: ${imageData.name}`;
            document.getElementById('imagenCompletaNombre').textContent = `Nombre: ${imageData.name}`;
            
            const detallesTextarea = document.getElementById('detallesTextarea');
            detallesTextarea.value = imageData.details || "";
            detallesTextarea.oninput = function() {
                galeriasData[currentLightboxImageInfo.sufijo][currentLightboxImageInfo.index].details = this.value;
            };
            
            const modal = document.getElementById('imagenCompletaModal');
            modal.classList.remove('hidden');
            void modal.offsetWidth; 
            modal.classList.remove('opacity-0');
            modal.classList.add('opacity-100');
        }

        function cerrarImagenCompleta() {
            const modal = document.getElementById('imagenCompletaModal');
            modal.classList.remove('opacity-100');
            modal.classList.add('opacity-0');
            setTimeout(() => {
                modal.classList.add('hidden');
                document.getElementById('imagenCompletaSrc').src = ""; 
                document.getElementById('detallesTextarea').value = "";
                currentLightboxImageInfo = { sufijo: null, index: null }; 
            }, 300);
        }

        function eliminarImagenActualDesdeLightbox() {
            if (currentLightboxImageInfo.sufijo === null || currentLightboxImageInfo.index === null) return;

            const { sufijo, index } = currentLightboxImageInfo;
            galeriasData[sufijo].splice(index, 1); 
            
            cerrarImagenCompleta(); 

            const galeriaDisplayId = 'galeriaDisplay' + sufijo;
            const galeriaMensajeId = 'galeriaMensaje' + sufijo;
            regenerarGaleria(sufijo, galeriaDisplayId, galeriaMensajeId);
             // Actualizar mensaje despu√©s de eliminar
            if (galeriasData[sufijo].length === 0) {
                document.getElementById(galeriaMensajeId).textContent = 'No hay im√°genes para mostrar.';
            } else {
                 document.getElementById(galeriaMensajeId).textContent = `${galeriasData[sufijo].length} im√°gen(es) en la galer√≠a.`;
            }
        }

        function mostrarManual(id, buttonElement) {
            const pdfIframe = document.getElementById(id);
            const pdfError = document.getElementById(id + 'Error');
            document.querySelectorAll('iframe').forEach(iframe => {
                if (iframe.id !== id) {
                    iframe.style.height = '0px';
                    iframe.classList.remove('h-[calc(100vh-200px)]', 'md:h-[600px]');
                }
            });
            if (activeButton && activeButton !== buttonElement) {
                 activeButton.classList.remove('bg-red-700');
                 activeButton.classList.add('bg-red-500');
            }
            if (pdfIframe) {
                if (pdfIframe.style.height === '0px' || pdfIframe.style.height === '') {
                    pdfIframe.style.height = 'calc(100vh - 200px)';
                    if (window.innerWidth >= 768) { pdfIframe.style.height = '600px';}
                    pdfIframe.classList.add('h-[calc(100vh-200px)]', 'md:h-[600px]');
                    buttonElement.classList.remove('bg-red-500'); buttonElement.classList.add('bg-red-700');
                    activeButton = buttonElement; visibleIframeId = id;
                    pdfIframe.onload = () => pdfError.classList.add('hidden');
                    pdfIframe.onerror = () => {
                        pdfError.classList.remove('hidden'); pdfIframe.style.height = '0px';
                        pdfIframe.classList.remove('h-[calc(100vh-200px)]', 'md:h-[600px]');
                    };
                } else {
                    pdfIframe.style.height = '0px';
                    pdfIframe.classList.remove('h-[calc(100vh-200px)]', 'md:h-[600px]');
                    buttonElement.classList.remove('bg-red-700'); buttonElement.classList.add('bg-red-500');
                    activeButton = null; visibleIframeId = null; pdfError.classList.add('hidden');
                }
            }
        }
        
        window.addEventListener('resize', () => {
            if (visibleIframeId) {
                const pdfIframe = document.getElementById(visibleIframeId);
                if (pdfIframe && (pdfIframe.style.height !== '0px' && pdfIframe.style.height !== '')) {
                     pdfIframe.style.height = 'calc(100vh - 200px)';
                    if (window.innerWidth >= 768) { pdfIframe.style.height = '600px'; }
                }
            }
        });

        function mostrarMensaje(titulo, contenido) {
            document.getElementById('mensajeModalTitulo').textContent = titulo;
            document.getElementById('mensajeModalContenido').textContent = contenido;
            const modal = document.getElementById('mensajeModal');
            modal.classList.remove('hidden'); void modal.offsetWidth; 
            modal.classList.remove('opacity-0'); modal.classList.add('opacity-100');
            modal.querySelector('.modal-content').classList.remove('scale-95');
            modal.querySelector('.modal-content').classList.add('scale-100');
        }

        function cerrarMensaje() {
            const modal = document.getElementById('mensajeModal');
            modal.classList.remove('opacity-100'); modal.classList.add('opacity-0');
            modal.querySelector('.modal-content').classList.remove('scale-100');
            modal.querySelector('.modal-content').classList.add('scale-95');
            setTimeout(() => { modal.classList.add('hidden'); }, 300);
        }

        document.addEventListener('keydown', function (event) {
            if (event.key === 'Escape') {
                const imagenModal = document.getElementById('imagenCompletaModal');
                if (!imagenModal.classList.contains('hidden')) {
                    cerrarImagenCompleta(); return;
                }
                const mensajeModal = document.getElementById('mensajeModal');
                 if (!mensajeModal.classList.contains('hidden')) {
                    cerrarMensaje();
                }
            }
        });

        // Inicializar galer√≠as y mensajes al cargar la p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            regenerarGaleria('Montero', 'galeriaDisplayMontero', 'galeriaMensajeMontero');
            regenerarGaleria('Lancer', 'galeriaDisplayLancer', 'galeriaMensajeLancer');
        });

    </script>
</body>
</html>
